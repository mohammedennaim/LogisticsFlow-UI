<div class="dashboard-container" [class.sidebar-collapsed]="sidebarCollapsed()">
  <!-- Sidebar Navigation -->
  <aside class="sidebar" [class.mobile-open]="mobileMenuOpen()">
    <div class="sidebar-header">
      <div class="logo">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="logo-icon">
          <path d="M3.375 4.5C2.339 4.5 1.5 5.34 1.5 6.375V13.5h12V6.375c0-1.036-.84-1.875-1.875-1.875h-8.25zM13.5 15h-12v2.625c0 1.035.84 1.875 1.875 1.875h.375a3 3 0 116 0h3a.75.75 0 00.75-.75V15z" />
          <path d="M8.25 19.5a1.5 1.5 0 10-3 0 1.5 1.5 0 003 0zM15.75 6.75a.75.75 0 00-.75.75v11.25c0 .087.015.17.042.248a3 3 0 015.958.464c.853-.175 1.522-.935 1.464-1.883a18.659 18.659 0 00-3.732-10.104 1.837 1.837 0 00-1.47-.725H15.75z" />
          <path d="M19.5 19.5a1.5 1.5 0 10-3 0 1.5 1.5 0 003 0z" />
        </svg>
      </div>
      <div class="header-text">
        <h2>LogisticsFlow</h2>
        <span class="role-badge admin">Administrateur</span>
      </div>
      <button class="sidebar-close-btn" (click)="closeMobileMenu()">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>
    </div>

    <nav class="sidebar-nav">
      <!-- Improved navigation with collapsible sections -->
      <div class="nav-section">
        <span class="nav-section-title">Principal</span>
        <button class="nav-item" [class.active]="activeMenu() === 'dashboard'" (click)="setActiveMenu('dashboard')">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25" />
          </svg>
          <span>Tableau de bord</span>
        </button>
      </div>

      <div class="nav-section">
        <button class="nav-section-toggle" (click)="toggleSection('management')" [class.expanded]="isSectionExpanded('management')">
          <span class="nav-section-title">Gestion</span>
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="toggle-icon">
            <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />
          </svg>
        </button>
        <div class="nav-items-group" [class.expanded]="isSectionExpanded('management')">
          <button class="nav-item" [class.active]="activeMenu() === 'warehouses'" (click)="setActiveMenu('warehouses')">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 21v-7.5a.75.75 0 01.75-.75h3a.75.75 0 01.75.75V21m-4.5 0H2.36m11.14 0H18m0 0h3.64m-1.39 0V9.349m-16.5 11.65V9.35m0 0a3.001 3.001 0 003.75-.615A2.993 2.993 0 009.75 9.75c.896 0 1.7-.393 2.25-1.016a2.993 2.993 0 002.25 1.016c.896 0 1.7-.393 2.25-1.016a3.001 3.001 0 003.75.614m-16.5 0a3.004 3.004 0 01-.621-4.72L4.318 3.44A1.5 1.5 0 015.378 3h13.243a1.5 1.5 0 011.06.44l1.19 1.189a3 3 0 01-.621 4.72m-13.5 8.65h3.75a.75.75 0 00.75-.75V13.5a.75.75 0 00-.75-.75H6.75a.75.75 0 00-.75.75v3.75c0 .415.336.75.75.75z" />
            </svg>
            <span>Entrep√¥ts</span>
            <span class="nav-badge">{{ warehouses().length }}</span>
          </button>
          <button class="nav-item" [class.active]="activeMenu() === 'carriers'" (click)="setActiveMenu('carriers')">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 18.75a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m3 0h6m-9 0H3.375a1.125 1.125 0 01-1.125-1.125V14.25m17.25 4.5a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m3 0h1.125c.621 0 1.129-.504 1.09-1.124a17.902 17.902 0 00-3.213-9.193 2.056 2.056 0 00-1.58-.86H14.25M16.5 18.75h-2.25m0-11.177v-.958c0-.568-.422-1.048-.987-1.106a48.554 48.554 0 00-10.026 0 1.106 1.106 0 00-.987 1.106v7.635m12-6.677v6.677m0 4.5v-4.5m0 0h-12" />
            </svg>
            <span>Transporteurs</span>
            <span class="nav-badge">{{ carriers().length }}</span>
          </button>
          <button class="nav-item" [class.active]="activeMenu() === 'products'" (click)="setActiveMenu('products')">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z" />
            </svg>
            <span>Produits</span>
            <span class="nav-badge">{{ products().length }}</span>
          </button>
          <button class="nav-item" [class.active]="activeMenu() === 'managers'" (click)="setActiveMenu('managers')">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z" />
            </svg>
            <span>Managers</span>
            <span class="nav-badge">{{ managers().length }}</span>
          </button>
          <button class="nav-item" [class.active]="activeMenu() === 'suppliers'" (click)="setActiveMenu('suppliers')">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 21h19.5m-18-18v18m10.5-18v18m6-13.5V21M6.75 6.75h.75m-.75 3h.75m-.75 3h.75m3-6h.75m-.75 3h.75m-.75 3h.75M6.75 21v-3.375c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21M3 3h12m-.75 4.5H21m-3.75 3.75h.008v.008h-.008v-.008zm0 3h.008v.008h-.008v-.008zm0 3h.008v.008h-.008v-.008z" />
            </svg>
            <span>Fournisseurs</span>
            <span class="nav-badge">{{ suppliers().length }}</span>
          </button>
          <button class="nav-item" [class.active]="activeMenu() === 'clients'" (click)="setActiveMenu('clients')">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z" />
            </svg>
            <span>Clients</span>
            <span class="nav-badge">{{ clients().length }}</span>
          </button>
        </div>
      </div>

      <div class="nav-section">
        <button class="nav-section-toggle" (click)="toggleSection('operations')" [class.expanded]="isSectionExpanded('operations')">
          <span class="nav-section-title">Op√©rations</span>
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="toggle-icon">
            <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />
          </svg>
        </button>
        <div class="nav-items-group" [class.expanded]="isSectionExpanded('operations')">
          <button class="nav-item" [class.active]="activeMenu() === 'orders'" (click)="setActiveMenu('orders')">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25zM6.75 12h.008v.008H6.75V12zm0 3h.008v.008H6.75V15zm0 3h.008v.008H6.75V18z" />
            </svg>
            <span>Commandes</span>
            <span class="nav-badge">{{ recentOrders().length }}</span>
          </button>
          <button class="nav-item" [class.active]="activeMenu() === 'shipments'" (click)="setActiveMenu('shipments')">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5" />
            </svg>
            <span>Exp√©ditions</span>
            <span class="nav-badge">{{ recentShipments().length }}</span>
          </button>
        </div>
      </div>

      <div class="nav-section">
        <span class="nav-section-title">Rapports</span>
        <button class="nav-item" [class.active]="activeMenu() === 'statistics'" (click)="setActiveMenu('statistics')">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 013 19.875v-6.75zM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V8.625zM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V4.125z" />
          </svg>
          <span>Statistiques</span>
        </button>
      </div>
    </nav>
  </aside>

  <!-- Main Content Area -->
  <main class="main-content">
    <!-- Header -->
    <header class="header">
      <div class="header-left">
        <button class="mobile-menu-btn" (click)="toggleMobileMenu()">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
          </svg>
        </button>
        <div>
          <h1>{{ getSectionTitle() }}</h1>
          <div class="header-subtitle">
            <p>{{ getSectionDescription() }}</p>
            <span class="last-update" [class.live]="autoRefreshEnabled()">
              <span class="live-dot"></span>
              Derni√®re M√†J: {{ lastUpdate() | date:'HH:mm:ss' }}
            </span>
          </div>
        </div>
      </div>
      <div class="header-right">
        <button class="auto-refresh-toggle" [class.active]="autoRefreshEnabled()" (click)="toggleAutoRefresh()" title="Actualisation automatique">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99" />
          </svg>
          {{ autoRefreshEnabled() ? 'Auto' : 'Manuel' }}
        </button>
        <button class="refresh-btn" (click)="loadDashboardData()" [disabled]="isLoading()" title="Actualiser">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" [class.spin]="isLoading()">
            <path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99" />
          </svg>
        </button>
        <div class="user-menu">
          <div class="user-avatar admin">{{ getUserInitials() }}</div>
          <div class="user-info">
            <span class="user-name">{{ currentUser()?.name }}</span>
            <span class="user-role">Administrateur</span>
          </div>
          <button class="logout-btn" (click)="logout()" title="D√©connexion">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15M12 9l-3 3m0 0l3 3m-3-3h12.75" />
            </svg>
          </button>
        </div>
      </div>
    </header>

    <!-- Loading State -->
    @if (isLoading()) {
    <div class="loading-overlay">
      <div class="loading-spinner"></div>
      <p>Chargement des donn√©es...</p>
    </div>
    }

    <!-- Dashboard Content -->
    <div class="dashboard-content" [class.loading]="isLoading()">
      
      <!-- ==================== DASHBOARD SECTION ==================== -->
      @if (activeMenu() === 'dashboard') {
        <!-- Stats Cards -->
        <div class="stats-grid">
          <div class="stat-card gradient-blue clickable" (click)="setActiveMenu('managers')">
            <div class="stat-icon">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z" />
              </svg>
            </div>
            <div class="stat-info">
              <span class="stat-value">{{ formatNumber(totalUsers()) }}</span>
              <span class="stat-label">Utilisateurs totaux</span>
            </div>
            <div class="stat-details">
              <span>{{ managers().length }} managers</span>
              <span>{{ clients().length }} clients</span>
            </div>
          </div>

          <div class="stat-card gradient-green clickable" (click)="setActiveMenu('warehouses')">
            <div class="stat-icon">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 21v-7.5a.75.75 0 01.75-.75h3a.75.75 0 01.75.75V21m-4.5 0H2.36m11.14 0H18m0 0h3.64m-1.39 0V9.349m-16.5 11.65V9.35m0 0a3.001 3.001 0 003.75-.615A2.993 2.993 0 009.75 9.75c.896 0 1.7-.393 2.25-1.016a2.993 2.993 0 002.25 1.016c.896 0 1.7-.393 2.25-1.016a3.001 3.001 0 003.75.614m-16.5 0a3.004 3.004 0 01-.621-4.72L4.318 3.44A1.5 1.5 0 015.378 3h13.243a1.5 1.5 0 011.06.44l1.19 1.189a3 3 0 01-.621 4.72m-13.5 8.65h3.75a.75.75 0 00.75-.75V13.5a.75.75 0 00-.75-.75H6.75a.75.75 0 00-.75.75v3.75c0 .415.336.75.75.75z" />
              </svg>
            </div>
            <div class="stat-info">
              <span class="stat-value">{{ warehouses().length }}</span>
              <span class="stat-label">Entrep√¥ts</span>
            </div>
            <div class="stat-details">
              <span>{{ activeWarehouses() }} actifs</span>
            </div>
          </div>

          <div class="stat-card gradient-purple clickable" (click)="setActiveMenu('carriers')">
            <div class="stat-icon">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 18.75a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m3 0h6m-9 0H3.375a1.125 1.125 0 01-1.125-1.125V14.25m17.25 4.5a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m3 0h1.125c.621 0 1.129-.504 1.09-1.124a17.902 17.902 0 00-3.213-9.193 2.056 2.056 0 00-1.58-.86H14.25M16.5 18.75h-2.25m0-11.177v-.958c0-.568-.422-1.048-.987-1.106a48.554 48.554 0 00-10.026 0 1.106 1.106 0 00-.987 1.106v7.635m12-6.677v6.677m0 4.5v-4.5m0 0h-12" />
              </svg>
            </div>
            <div class="stat-info">
              <span class="stat-value">{{ carriers().length }}</span>
              <span class="stat-label">Transporteurs</span>
            </div>
            <div class="stat-details">
              <span>{{ activeCarriers() }} disponibles</span>
            </div>
          </div>

          <div class="stat-card gradient-orange clickable" (click)="setActiveMenu('statistics')">
            <div class="stat-icon">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 18.75a60.07 60.07 0 0115.797 2.101c.727.198 1.453-.342 1.453-1.096V18.75M3.75 4.5v.75A.75.75 0 013 6h-.75m0 0v-.375c0-.621.504-1.125 1.125-1.125H20.25M2.25 6v9m18-10.5v.75c0 .414.336.75.75.75h.75m-1.5-1.5h.375c.621 0 1.125.504 1.125 1.125v9.75c0 .621-.504 1.125-1.125 1.125h-.375m1.5-1.5H21a.75.75 0 00-.75.75v.75m0 0H3.75m0 0h-.375a1.125 1.125 0 01-1.125-1.125V15m1.5 1.5v-.75A.75.75 0 003 15h-.75M15 10.5a3 3 0 11-6 0 3 3 0 016 0zm3 0h.008v.008H18V10.5zm-12 0h.008v.008H6V10.5z" />
              </svg>
            </div>
            <div class="stat-info">
              <span class="stat-value">{{ formatCurrency(totalRevenue()) }}</span>
              <span class="stat-label">Revenus totaux</span>
            </div>
            <div class="stat-details">
              <span>{{ orderReport()?.totalOrders || 0 }} commandes</span>
            </div>
          </div>
        </div>

        <!-- Added Quick Actions section -->
        <div class="quick-actions-section">
          <h3>‚ö° Actions rapides</h3>
          <div class="quick-actions-grid">
            <button class="quick-action-btn" (click)="setActiveMenu('warehouses'); openWarehouseModal()">
              <span class="quick-action-icon">üè≠</span>
              <span>Nouvel entrep√¥t</span>
            </button>
            <button class="quick-action-btn" (click)="setActiveMenu('carriers'); openCarrierModal()">
              <span class="quick-action-icon">üöö</span>
              <span>Nouveau transporteur</span>
            </button>
            <button class="quick-action-btn" (click)="setActiveMenu('products'); openProductModal()">
              <span class="quick-action-icon">üì¶</span>
              <span>Nouveau produit</span>
            </button>
            <button class="quick-action-btn" (click)="setActiveMenu('managers'); openManagerModal()">
              <span class="quick-action-icon">üë§</span>
              <span>Nouveau manager</span>
            </button>
            <button class="quick-action-btn" (click)="setActiveMenu('suppliers'); openSupplierModal()">
              <span class="quick-action-icon">üè¢</span>
              <span>Nouveau fournisseur</span>
            </button>
          </div>
        </div>

      }

      <!-- ==================== WAREHOUSES SECTION ==================== -->
      @if (activeMenu() === 'warehouses') {
        <!-- Improved table with search and better styling -->
        <div class="data-section">
          <div class="section-header">
            <div>
              <h2>Gestion des Entrep√¥ts</h2>
              <p>G√©rez et visualisez tous vos entrep√¥ts</p>
            </div>
            <button class="btn-primary" (click)="openWarehouseModal()">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
              </svg>
              Ajouter
            </button>
          </div>

          <div class="search-bar">
            <input type="text" placeholder="Rechercher par nom ou code..." [(ngModel)]="searchFilter" class="search-input">
          </div>

          @if (getFilteredWarehouses().length > 0) {
            <div class="table-responsive">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>Nom</th>
                    <th>Code</th>
                    <th>Adresse</th>
                    <th>Capacit√©</th>
                    <th>Status</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody>
                  @for (warehouse of getFilteredWarehouses(); track warehouse.id) {
                    <tr>
                      <td><strong>{{ warehouse.name }}</strong></td>
                      <td>{{ warehouse.code }}</td>
                      <td>{{ warehouse.address }} {{ warehouse.city }}</td>
                      <td>{{ warehouse.capacity }} u.</td>
                      <td>
                        <span class="status-badge" [ngClass]="warehouse.active ? 'active' : 'inactive'">
                          {{ warehouse.active ? 'Actif' : 'Inactif' }}
                        </span>
                      </td>
                      <td>
                        <div class="action-buttons">
                          <button class="btn-icon edit" (click)="openWarehouseModal(warehouse)" title="Modifier">‚úèÔ∏è</button>
                          <button class="btn-icon delete" (click)="deleteWarehouse(warehouse.id)" title="Supprimer">üóëÔ∏è</button>
                        </div>
                      </td>
                    </tr>
                  }
                </tbody>
              </table>
            </div>
          } @else {
            <div class="empty-state">
              <p>Aucun entrep√¥t trouv√©</p>
              <button class="btn-secondary" (click)="openWarehouseModal()">Cr√©er un entrep√¥t</button>
            </div>
          }
        </div>
      }

      <!-- ==================== CARRIERS SECTION ==================== -->
      @if (activeMenu() === 'carriers') {
        <div class="data-section">
          <div class="section-header">
            <div>
              <h2>Gestion des Transporteurs</h2>
              <p>G√©rez vos partenaires de transport</p>
            </div>
            <button class="btn-primary" (click)="openCarrierModal()">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
              </svg>
              Ajouter
            </button>
          </div>

          <div class="search-bar">
            <input type="text" placeholder="Rechercher par nom ou code..." [(ngModel)]="searchFilter" class="search-input">
          </div>

          @if (getFilteredCarriers().length > 0) {
            <div class="table-responsive">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>Nom</th>
                    <th>Code</th>
                    <th>Email</th>
                    <th>T√©l√©phone</th>
                    <th>Tarif</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody>
                  @for (carrier of getFilteredCarriers(); track carrier.id) {
                    <tr>
                      <td><strong>{{ carrier.name }}</strong></td>
                      <td>{{ carrier.code }}</td>
                      <td>{{ carrier.email }}</td>
                      <td>{{ carrier.phone }}</td>
                      <td>{{ formatCurrency(carrier.rate || 0) }}</td>
                      <td>
                        <div class="action-buttons">
                          <button class="btn-icon edit" (click)="openCarrierModal(carrier)" title="Modifier">‚úèÔ∏è</button>
                          <button class="btn-icon delete" (click)="deleteCarrier(carrier.id)" title="Supprimer">üóëÔ∏è</button>
                        </div>
                      </td>
                    </tr>
                  }
                </tbody>
              </table>
            </div>
          } @else {
            <div class="empty-state">
              <p>Aucun transporteur trouv√©</p>
              <button class="btn-secondary" (click)="openCarrierModal()">Cr√©er un transporteur</button>
            </div>
          }
        </div>
      }

      <!-- ==================== PRODUCTS SECTION ==================== -->
      @if (activeMenu() === 'products') {
        <div class="data-section">
          <div class="section-header">
            <div>
              <h2>Gestion des Produits</h2>
              <p>G√©rez votre catalogue de produits</p>
            </div>
            <button class="btn-primary" (click)="openProductModal()">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
              </svg>
              Ajouter
            </button>
          </div>

          <div class="search-bar">
            <input type="text" placeholder="Rechercher par nom ou SKU..." [(ngModel)]="searchFilter" class="search-input">
          </div>

          @if (getFilteredProducts().length > 0) {
            <div class="table-responsive">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>SKU</th>
                    <th>Nom</th>
                    <th>Cat√©gorie</th>
                    <th>Prix</th>
                    <th>Marge</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody>
                  @for (product of getFilteredProducts(); track product.id) {
                    <tr>
                      <td><code>{{ product.sku }}</code></td>
                      <td><strong>{{ product.name }}</strong></td>
                      <td>{{ product.category || 'Non cat√©goris√©' }}</td>
                      <td class="price">{{ formatCurrency(product.unitPrice) }}</td>
                      <td>{{ product.profit || 0 }} DH</td>
                      <td>
                        <div class="action-buttons">
                          <button class="btn-icon edit" (click)="openProductModal(product)" title="Modifier">‚úèÔ∏è</button>
                          <button class="btn-icon delete" (click)="deleteProduct(product.id)" title="Supprimer">üóëÔ∏è</button>
                        </div>
                      </td>
                    </tr>
                  }
                </tbody>
              </table>
            </div>
          } @else {
            <div class="empty-state">
              <p>Aucun produit trouv√©</p>
              <button class="btn-secondary" (click)="openProductModal()">Cr√©er un produit</button>
            </div>
          }
        </div>
      }

      <!-- ==================== MANAGERS SECTION ==================== -->
      @if (activeMenu() === 'managers') {
        <div class="data-section">
          <div class="section-header">
            <div>
              <h2>Gestion des Managers</h2>
              <p>G√©rez les gestionnaires d'entrep√¥ts</p>
            </div>
            <button class="btn-primary" (click)="openManagerModal()">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
              </svg>
              Ajouter
            </button>
          </div>

          <div class="search-bar">
            <input type="text" placeholder="Rechercher par nom ou email..." [(ngModel)]="searchFilter" class="search-input">
          </div>

          @if (getFilteredManagers().length > 0) {
            <div class="table-responsive">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>Manager</th>
                    <th>Email</th>
                    <th>Entrep√¥ts</th>
                    <th>Statut</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody>
                  @for (manager of getFilteredManagers(); track manager.id) {
                    <tr>
                      <td>
                        <div class="manager-cell">
                          <div class="avatar">{{ getManagerInitials(manager.email) }}</div>
                          <strong>{{ manager.name || manager.email }}</strong>
                        </div>
                      </td>
                      <td>{{ manager.email }}</td>
                      <td>{{ manager.warehouseIds?.length || 0 }} entrep√¥t(s)</td>
                      <td>
                        <span class="status-badge" [class.active]="manager.active" [class.inactive]="!manager.active">
                          {{ manager.active ? 'Actif' : 'Inactif' }}
                        </span>
                      </td>
                      <td>
                        <div class="action-buttons">
                          <button class="btn-icon edit" (click)="openManagerModal(manager)" title="Modifier">‚úèÔ∏è</button>
                          <button class="btn-icon delete" (click)="deleteManager(manager.id)" title="Supprimer">üóëÔ∏è</button>
                        </div>
                      </td>
                    </tr>
                  }
                </tbody>
              </table>
            </div>
          } @else {
            <div class="empty-state">
              <p>Aucun manager trouv√©</p>
              <button class="btn-secondary" (click)="openManagerModal()">Cr√©er un manager</button>
            </div>
          }
        </div>
      }

      <!-- ==================== SUPPLIERS SECTION ==================== -->
      @if (activeMenu() === 'suppliers') {
        <div class="data-section">
          <div class="section-header">
            <div>
              <h2>Gestion des Fournisseurs</h2>
              <p>G√©rez vos partenaires fournisseurs</p>
            </div>
            <button class="btn-primary" (click)="openSupplierModal()">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
              </svg>
              Ajouter
            </button>
          </div>

          <div class="search-bar">
            <input type="text" placeholder="Rechercher par nom..." [(ngModel)]="searchFilter" class="search-input">
          </div>

          @if (getFilteredSuppliers().length > 0) {
            <div class="table-responsive">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>Nom</th>
                    <th>Contact</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody>
                  @for (supplier of getFilteredSuppliers(); track supplier.id) {
                    <tr>
                      <td><strong>{{ supplier.name }}</strong></td>
                      <td>{{ supplier.contact || 'Non renseign√©' }}</td>
                      <td>
                        <div class="action-buttons">
                          <button class="btn-icon edit" (click)="openSupplierModal(supplier)" title="Modifier">‚úèÔ∏è</button>
                          <button class="btn-icon delete" (click)="deleteSupplier(supplier.id)" title="Supprimer">üóëÔ∏è</button>
                        </div>
                      </td>
                    </tr>
                  }
                </tbody>
              </table>
            </div>
          } @else {
            <div class="empty-state">
              <p>Aucun fournisseur trouv√©</p>
              <button class="btn-secondary" (click)="openSupplierModal()">Cr√©er un fournisseur</button>
            </div>
          }
        </div>
      }

      <!-- ==================== CLIENTS SECTION ==================== -->
      @if (activeMenu() === 'clients') {
        <div class="data-section">
          <div class="section-header">
            <div>
              <h2>Gestion des Clients</h2>
              <p>Base de donn√©es de vos clients</p>
            </div>
          </div>

          <div class="search-bar">
            <input type="text" placeholder="Rechercher par nom..." [(ngModel)]="searchFilter" class="search-input">
          </div>

          @if (getFilteredClients().length > 0) {
            <div class="table-responsive">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>Nom</th>
                    <th>Contact</th>
                    <th>Statut</th>
                  </tr>
                </thead>
                <tbody>
                  @for (client of getFilteredClients(); track client.id) {
                    <tr>
                      <td>
                        <div class="manager-cell">
                          <div class="avatar client">{{ client.name?.charAt(0)?.toUpperCase() || 'C' }}</div>
                          <strong>{{ client.name }}</strong>
                        </div>
                      </td>
                      <td>{{ client.contact || 'Non renseign√©' }}</td>
                      <td>
                        <span class="status-badge" [class.active]="client.active">
                          {{ client.active ? 'Actif' : 'Inactif' }}
                        </span>
                      </td>
                    </tr>
                  }
                </tbody>
              </table>
            </div>
          } @else {
            <div class="empty-state">
              <p>Aucun client trouv√©</p>
            </div>
          }
        </div>
      }

      <!-- ==================== ORDERS SECTION ==================== -->
      @if (activeMenu() === 'orders') {
        <div class="data-section">
          <div class="section-header">
            <div>
              <h2>Gestion des Commandes</h2>
              <p>Suivi de toutes les commandes clients</p>
            </div>
          </div>

          <div class="search-bar">
            <input type="text" placeholder="Rechercher par num√©ro de commande..." [(ngModel)]="searchFilter" class="search-input">
          </div>

          @if (recentOrders().length > 0) {
            <div class="table-responsive">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>N¬∞ Commande</th>
                    <th>Client</th>
                    <th>Montant</th>
                    <th>Statut</th>
                    <th>Date</th>
                    <th>Adresse</th>
                  </tr>
                </thead>
                <tbody>
                  @for (order of recentOrders(); track order.id) {
                    <tr>
                      <td><strong>{{ order.orderNumber }}</strong></td>
                      <td>{{ order.clientName || 'Client inconnu' }}</td>
                      <td class="price">{{ order.totalAmount | number:'1.2-2' }} DH</td>
                      <td>
                        <span class="status-badge" [ngClass]="order.status.toLowerCase()">
                          {{ getOrderStatusLabel(order.status) }}
                        </span>
                      </td>
                      <td>{{ order.createdAt | date:'dd/MM/yyyy HH:mm' }}</td>
                      <td>{{ order.shippingAddress || 'Non renseign√©e' }}</td>
                    </tr>
                  }
                </tbody>
              </table>
            </div>
          } @else {
            <div class="empty-state">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="empty-icon">
                <path stroke-linecap="round" stroke-linejoin="round" d="M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25z" />
              </svg>
              <p>Aucune commande pour le moment</p>
            </div>
          }
        </div>
      }

      <!-- ==================== SHIPMENTS SECTION ==================== -->
      @if (activeMenu() === 'shipments') {
        <div class="data-section">
          <div class="section-header">
            <div>
              <h2>Gestion des Exp√©ditions</h2>
              <p>Suivi en temps r√©el des livraisons</p>
            </div>
          </div>

          <div class="search-bar">
            <input type="text" placeholder="Rechercher par num√©ro de suivi..." [(ngModel)]="searchFilter" class="search-input">
          </div>

          @if (recentShipments().length > 0) {
            <div class="table-responsive">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>N¬∞ Suivi</th>
                    <th>Commande</th>
                    <th>Transporteur</th>
                    <th>Entrep√¥t</th>
                    <th>Statut</th>
                    <th>Date d'exp√©dition</th>
                    <th>Livraison estim√©e</th>
                  </tr>
                </thead>
                <tbody>
                  @for (shipment of recentShipments(); track shipment.id) {
                    <tr>
                      <td><strong>{{ shipment.trackingNumber || 'N/A' }}</strong></td>
                      <td>{{ shipment.orderNumber || shipment.orderId }}</td>
                      <td>{{ shipment.carrierName || 'Non assign√©' }}</td>
                      <td>{{ shipment.warehouseName || 'N/A' }}</td>
                      <td>
                        <span class="status-badge" [ngClass]="shipment.status.toLowerCase()">
                          {{ getShipmentStatusLabel(shipment.status) }}
                        </span>
                      </td>
                      <td>{{ shipment.shippedAt ? (shipment.shippedAt | date:'dd/MM/yyyy') : 'Non exp√©di√©e' }}</td>
                      <td>{{ shipment.estimatedDelivery ? (shipment.estimatedDelivery | date:'dd/MM/yyyy') : 'N/A' }}</td>
                    </tr>
                  }
                </tbody>
              </table>
            </div>
          } @else {
            <div class="empty-state">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="empty-icon">
                <path stroke-linecap="round" stroke-linejoin="round" d="M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5" />
              </svg>
              <p>Aucune exp√©dition pour le moment</p>
            </div>
          }
        </div>
      }

      <!-- ==================== STATISTICS SECTION ==================== -->
      @if (activeMenu() === 'statistics') {
        <div class="data-section statistics-section">
          <div class="section-header">
            <div>
              <h2>Statistiques & Rapports</h2>
              <p>Vue d'ensemble des performances de votre logistique</p>
            </div>
          </div>

          <!-- Order Statistics -->
          <div class="stats-group">
            <h3 class="stats-group-title">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25z" />
              </svg>
              Statistiques des Commandes
            </h3>
            <div class="stats-grid">
              <div class="stat-card blue">
                <div class="stat-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 010 3.75H5.625a1.875 1.875 0 010-3.75z" />
                  </svg>
                </div>
                <div class="stat-content">
                  <span class="stat-value">{{ orderReport()?.totalOrders || 0 }}</span>
                  <span class="stat-label">Total Commandes</span>
                </div>
              </div>
              <div class="stat-card orange">
                <div class="stat-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z" />
                  </svg>
                </div>
                <div class="stat-content">
                  <span class="stat-value">{{ orderReport()?.pendingOrders || 0 }}</span>
                  <span class="stat-label">En attente</span>
                </div>
              </div>
              <div class="stat-card green">
                <div class="stat-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                  </svg>
                </div>
                <div class="stat-content">
                  <span class="stat-value">{{ orderReport()?.deliveredOrders || 0 }}</span>
                  <span class="stat-label">Livr√©es</span>
                </div>
              </div>
              <div class="stat-card purple">
                <div class="stat-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v12m-3-2.818l.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                  </svg>
                </div>
                <div class="stat-content">
                  <span class="stat-value">{{ (orderReport()?.totalRevenue || 0) | number:'1.0-0' }} DH</span>
                  <span class="stat-label">Revenu Total</span>
                </div>
              </div>
              <div class="stat-card teal">
                <div class="stat-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 18.75a60.07 60.07 0 0115.797 2.101c.727.198 1.453-.342 1.453-1.096V18.75M3.75 4.5v.75A.75.75 0 013 6h-.75m0 0v-.375c0-.621.504-1.125 1.125-1.125H20.25M2.25 6v9m18-10.5v.75c0 .414.336.75.75.75h.75m-1.5-1.5h.375c.621 0 1.125.504 1.125 1.125v9.75c0 .621-.504 1.125-1.125 1.125h-.375m1.5-1.5H21a.75.75 0 00-.75.75v.75m0 0H3.75m0 0h-.375a1.125 1.125 0 01-1.125-1.125V15m1.5 1.5v-.75A.75.75 0 003 15h-.75M15 10.5a3 3 0 11-6 0 3 3 0 016 0zm3 0h.008v.008H18V10.5zm-12 0h.008v.008H6V10.5z" />
                  </svg>
                </div>
                <div class="stat-content">
                  <span class="stat-value">{{ (orderReport()?.averageOrderValue || 0) | number:'1.0-0' }} DH</span>
                  <span class="stat-label">Panier Moyen</span>
                </div>
              </div>
              <div class="stat-card red">
                <div class="stat-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                  </svg>
                </div>
                <div class="stat-content">
                  <span class="stat-value">{{ orderReport()?.cancelledOrders || 0 }}</span>
                  <span class="stat-label">Annul√©es</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Shipment Statistics -->
          <div class="stats-group">
            <h3 class="stats-group-title">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 18.75a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m3 0h6m-9 0H3.375a1.125 1.125 0 01-1.125-1.125V14.25m17.25 4.5a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m3 0h1.125c.621 0 1.129-.504 1.09-1.124a17.902 17.902 0 00-3.213-9.193 2.056 2.056 0 00-1.58-.86H14.25M16.5 18.75h-2.25m0-11.177v-.958c0-.568-.422-1.048-.987-1.106a48.554 48.554 0 00-10.026 0 1.106 1.106 0 00-.987 1.106v7.635m12-6.677v6.677m0 4.5v-4.5m0 0h-12" />
              </svg>
              Statistiques des Exp√©ditions
            </h3>
            <div class="stats-grid">
              <div class="stat-card blue">
                <div class="stat-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5" />
                  </svg>
                </div>
                <div class="stat-content">
                  <span class="stat-value">{{ shipmentReport()?.totalShipments || 0 }}</span>
                  <span class="stat-label">Total Exp√©ditions</span>
                </div>
              </div>
              <div class="stat-card cyan">
                <div class="stat-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 18.75a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m3 0h6m-9 0H3.375a1.125 1.125 0 01-1.125-1.125V14.25m17.25 4.5a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m3 0h1.125c.621 0 1.129-.504 1.09-1.124a17.902 17.902 0 00-3.213-9.193 2.056 2.056 0 00-1.58-.86H14.25M16.5 18.75h-2.25m0-11.177v-.958c0-.568-.422-1.048-.987-1.106a48.554 48.554 0 00-10.026 0 1.106 1.106 0 00-.987 1.106v7.635m12-6.677v6.677m0 4.5v-4.5m0 0h-12" />
                  </svg>
                </div>
                <div class="stat-content">
                  <span class="stat-value">{{ shipmentReport()?.inTransitShipments || 0 }}</span>
                  <span class="stat-label">En Transit</span>
                </div>
              </div>
              <div class="stat-card green">
                <div class="stat-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                  </svg>
                </div>
                <div class="stat-content">
                  <span class="stat-value">{{ shipmentReport()?.deliveredShipments || 0 }}</span>
                  <span class="stat-label">Livr√©es</span>
                </div>
              </div>
              <div class="stat-card orange">
                <div class="stat-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z" />
                  </svg>
                </div>
                <div class="stat-content">
                  <span class="stat-value">{{ shipmentReport()?.pendingShipments || 0 }}</span>
                  <span class="stat-label">En Attente</span>
                </div>
              </div>
              <div class="stat-card purple">
                <div class="stat-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 013 19.875v-6.75zM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V8.625zM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V4.125z" />
                  </svg>
                </div>
                <div class="stat-content">
                  <span class="stat-value">{{ (shipmentReport()?.onTimeDeliveryRate || 0) | number:'1.0-0' }}%</span>
                  <span class="stat-label">Taux de Livraison √† Temps</span>
                </div>
              </div>
              <div class="stat-card teal">
                <div class="stat-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z" />
                  </svg>
                </div>
                <div class="stat-content">
                  <span class="stat-value">{{ (shipmentReport()?.averageDeliveryTime || 0) | number:'1.1-1' }}j</span>
                  <span class="stat-label">D√©lai Moyen</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Inventory Statistics -->
          <div class="stats-group">
            <h3 class="stats-group-title">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z" />
              </svg>
              Statistiques de l'Inventaire
            </h3>
            <div class="stats-grid">
              <div class="stat-card blue">
                <div class="stat-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5m16.5 0V4.875c0-.621-.504-1.125-1.125-1.125H4.875c-.621 0-1.125.504-1.125 1.125V7.5m16.5 0h-16.5" />
                  </svg>
                </div>
                <div class="stat-content">
                  <span class="stat-value">{{ inventoryReport()?.totalProducts || 0 }}</span>
                  <span class="stat-label">Total Produits</span>
                </div>
              </div>
              <div class="stat-card green">
                <div class="stat-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 010 3.75H5.625a1.875 1.875 0 010-3.75z" />
                  </svg>
                </div>
                <div class="stat-content">
                  <span class="stat-value">{{ inventoryReport()?.totalQuantity || 0 }}</span>
                  <span class="stat-label">Quantit√© Totale</span>
                </div>
              </div>
              <div class="stat-card orange">
                <div class="stat-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" />
                  </svg>
                </div>
                <div class="stat-content">
                  <span class="stat-value">{{ inventoryReport()?.lowStockItems || 0 }}</span>
                  <span class="stat-label">Stock Faible</span>
                </div>
              </div>
              <div class="stat-card red">
                <div class="stat-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636" />
                  </svg>
                </div>
                <div class="stat-content">
                  <span class="stat-value">{{ inventoryReport()?.outOfStockItems || 0 }}</span>
                  <span class="stat-label">Rupture de Stock</span>
                </div>
              </div>
              <div class="stat-card purple">
                <div class="stat-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v12m-3-2.818l.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                  </svg>
                </div>
                <div class="stat-content">
                  <span class="stat-value">{{ (inventoryReport()?.totalInventoryValue || 0) | number:'1.0-0' }} DH</span>
                  <span class="stat-label">Valeur du Stock</span>
                </div>
              </div>
              <div class="stat-card teal">
                <div class="stat-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 18L9 11.25l4.306 4.307a11.95 11.95 0 015.814-5.519l2.74-1.22m0 0l-5.94-2.28m5.94 2.28l-2.28 5.941" />
                  </svg>
                </div>
                <div class="stat-content">
                  <span class="stat-value">{{ inventoryReport()?.overStockItems || 0 }}</span>
                  <span class="stat-label">Surstock</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Charts Section -->
          <div class="charts-section">
            <h3 class="charts-section-title">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 013 19.875v-6.75zM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V8.625zM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V4.125z" />
              </svg>
              Graphiques Interactifs
            </h3>

            <div class="charts-grid">
              <!-- Order Status Doughnut Chart -->
              <div class="chart-container">
                <canvas id="orderStatusChart"></canvas>
              </div>

              <!-- Shipment Status Bar Chart -->
              <div class="chart-container">
                <canvas id="shipmentStatusChart"></canvas>
              </div>

              <!-- Revenue Line Chart -->
              <div class="chart-container chart-wide">
                <canvas id="revenueChart"></canvas>
              </div>

              <!-- Inventory Polar Area Chart -->
              <div class="chart-container">
                <canvas id="inventoryChart"></canvas>
              </div>
            </div>
          </div>
        </div>
      }

      <!-- ==================== MODALS ==================== -->
      <!-- Warehouse Modal -->
      @if (showWarehouseModal()) {
        <div class="modal-overlay" (click)="closeModal()">
          <div class="modal" (click)="$event.stopPropagation()">
            <div class="modal-header">
              <h2>{{ editingItem() ? 'Modifier l\'entrep√¥t' : 'Nouvel entrep√¥t' }}</h2>
              <button class="modal-close" (click)="closeModal()">√ó</button>
            </div>
            <div class="modal-body">
              <div class="form-group">
                <label>Code <span class="required">*</span></label>
                <input type="text" [(ngModel)]="warehouseForm.code" placeholder="WH-001" class="form-input" required>
              </div>
              <div class="form-group">
                <label>Nom <span class="required">*</span></label>
                <input type="text" [(ngModel)]="warehouseForm.name" placeholder="Nom de l'entrep√¥t" class="form-input" required>
              </div>
              <div class="form-group checkbox">
                <label>
                  <input type="checkbox" [(ngModel)]="warehouseForm.active">
                  <span>Actif</span>
                </label>
              </div>
            </div>
            <div class="modal-footer">
              <button class="btn-secondary" (click)="closeModal()">Annuler</button>
              <button class="btn-primary" (click)="saveWarehouse()">{{ editingItem() ? 'Modifier' : 'Cr√©er' }}</button>
            </div>
          </div>
        </div>
      }

      <!-- Carrier Modal -->
      @if (showCarrierModal()) {
        <div class="modal-overlay" (click)="closeModal()">
          <div class="modal" (click)="$event.stopPropagation()">
            <div class="modal-header">
              <h2>{{ editingItem() ? 'Modifier le transporteur' : 'Nouveau transporteur' }}</h2>
              <button class="modal-close" (click)="closeModal()">√ó</button>
            </div>
            <div class="modal-body">
              <div class="form-group">
                <label>Code</label>
                <input type="text" [(ngModel)]="carrierForm.code" placeholder="Code du transporteur" class="form-input">
              </div>
              <div class="form-group">
                <label>Nom</label>
                <input type="text" [(ngModel)]="carrierForm.name" placeholder="Nom" class="form-input">
              </div>
              <div class="form-group">
                <label>Email</label>
                <input type="email" [(ngModel)]="carrierForm.email" placeholder="Email" class="form-input">
              </div>
              <div class="form-group">
                <label>T√©l√©phone</label>
                <input type="tel" [(ngModel)]="carrierForm.phone" placeholder="T√©l√©phone" class="form-input">
              </div>
              <div class="form-row">
                <div class="form-group">
                  <label>Tarif</label>
                  <input type="number" [(ngModel)]="carrierForm.rate" placeholder="Tarif" class="form-input">
                </div>
                <div class="form-group">
                  <label>Max. exp√©ditions/jour</label>
                  <input type="number" [(ngModel)]="carrierForm.maxDailyShipments" placeholder="Nombre" class="form-input">
                </div>
              </div>
            </div>
            <div class="modal-footer">
              <button class="btn-secondary" (click)="closeModal()">Annuler</button>
              <button class="btn-primary" (click)="saveCarrier()">{{ editingItem() ? 'Modifier' : 'Cr√©er' }}</button>
            </div>
          </div>
        </div>
      }

      <!-- Product Modal -->
      @if (showProductModal()) {
        <div class="modal-overlay" (click)="closeModal()">
          <div class="modal" (click)="$event.stopPropagation()">
            <div class="modal-header">
              <h2>{{ editingItem() ? 'Modifier le produit' : 'Nouveau produit' }}</h2>
              <button class="modal-close" (click)="closeModal()">√ó</button>
            </div>
            <div class="modal-body">
              <div class="form-group">
                <label>SKU</label>
                <input type="text" [(ngModel)]="productForm.sku" placeholder="SKU" class="form-input">
              </div>
              <div class="form-group">
                <label>Nom <span class="required">*</span></label>
                <input type="text" [(ngModel)]="productForm.name" placeholder="Nom du produit" class="form-input" required>
              </div>
              <div class="form-group">
                <label>Cat√©gorie</label>
                <input type="text" [(ngModel)]="productForm.category" placeholder="Cat√©gorie" class="form-input">
              </div>
              <div class="form-row">
                <div class="form-group">
                  <label>Prix unitaire <span class="required">*</span></label>
                  <input type="number" [(ngModel)]="productForm.unitPrice" placeholder="Prix" class="form-input" min="0.01" step="0.01" required>
                </div>
                <div class="form-group">
                  <label>Marge b√©n√©ficiaire</label>
                  <input type="number" [(ngModel)]="productForm.profit" placeholder="Profit" class="form-input" min="0" step="0.01">
                </div>
              </div>
              <div class="form-group">
                <label>URL Image</label>
                <input type="text" [(ngModel)]="productForm.image" placeholder="https://example.com/image.jpg" class="form-input">
              </div>
            </div>
            <div class="modal-footer">
              <button class="btn-secondary" (click)="closeModal()">Annuler</button>
              <button class="btn-primary" (click)="saveProduct()">{{ editingItem() ? 'Modifier' : 'Cr√©er' }}</button>
            </div>
          </div>
        </div>
      }

      <!-- Manager Modal -->
      @if (showManagerModal()) {
        <div class="modal-overlay" (click)="closeModal()">
          <div class="modal" (click)="$event.stopPropagation()">
            <div class="modal-header">
              <h2>{{ editingItem() ? 'Modifier le manager' : 'Nouveau manager' }}</h2>
              <button class="modal-close" (click)="closeModal()">√ó</button>
            </div>
            <div class="modal-body">
              <div class="form-group">
                <label>Email <span class="required">*</span></label>
                <input type="email" [(ngModel)]="managerForm.email" placeholder="manager@example.com" class="form-input" required>
              </div>
              @if (!editingItem()) {
                <div class="form-group">
                  <label>Mot de passe <span class="required">*</span></label>
                  <input type="password" [(ngModel)]="managerForm.password" placeholder="Mot de passe" class="form-input" required minlength="6">
                </div>
              }
              <div class="form-group">
                <label>Entrep√¥ts assign√©s</label>
                <select multiple [(ngModel)]="managerForm.warehouseIds" class="form-input multi-select">
                  @for (warehouse of warehouses(); track warehouse.id) {
                    <option [value]="warehouse.id">{{ warehouse.name }} ({{ warehouse.code }})</option>
                  }
                </select>
                <small class="form-hint">Maintenez Ctrl pour s√©lectionner plusieurs</small>
              </div>
              <div class="form-group checkbox">
                <label>
                  <input type="checkbox" [(ngModel)]="managerForm.active">
                  <span>Actif</span>
                </label>
              </div>
            </div>
            <div class="modal-footer">
              <button class="btn-secondary" (click)="closeModal()">Annuler</button>
              <button class="btn-primary" (click)="saveManager()">{{ editingItem() ? 'Modifier' : 'Cr√©er' }}</button>
            </div>
          </div>
        </div>
      }

      <!-- Supplier Modal -->
      @if (showSupplierModal()) {
        <div class="modal-overlay" (click)="closeModal()">
          <div class="modal" (click)="$event.stopPropagation()">
            <div class="modal-header">
              <h2>{{ editingItem() ? 'Modifier le fournisseur' : 'Nouveau fournisseur' }}</h2>
              <button class="modal-close" (click)="closeModal()">√ó</button>
            </div>
            <div class="modal-body">
              <div class="form-group">
                <label>Nom</label>
                <input type="text" [(ngModel)]="supplierForm.name" placeholder="Nom du fournisseur" class="form-input">
              </div>
              <div class="form-group">
                <label>Contact</label>
                <input type="text" [(ngModel)]="supplierForm.contact" placeholder="Contact" class="form-input">
              </div>
            </div>
            <div class="modal-footer">
              <button class="btn-secondary" (click)="closeModal()">Annuler</button>
              <button class="btn-primary" (click)="saveSupplier()">{{ editingItem() ? 'Modifier' : 'Cr√©er' }}</button>
            </div>
          </div>
        </div>
      }
    </div>
  </main>
</div>
